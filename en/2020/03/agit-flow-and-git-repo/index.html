<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Agit-Flow and git-repo – git-repo: a git wrapper from Alibaba</title>
    
<script src="/js/enquire.min.dfb99dee1e029d51d6cfb672d847929890b1585402de17f5ed092edd72a688b4.js"></script>

<script defer src="/js/fuse.min.94c78ad70b02749822921660cf4e9f0b3701bc0680c421afb784a78228de0275.js"></script>

<script defer src="/js/lazysizes.min.31dd6a2d3a1ec0f78a8df007535cf23f03aeb5c70f026e6d6a19dac3b3acc340.js"></script>

<script defer src="/js/helper/getParents.min.1618c696be7c98933f9a92677f518b512a74e55bdbb976b09936b4182e93181b.js"></script>

<script defer src="/js/helper/fadeinout.min.93a331f96194789a542f33690bbe4f0c102c7e78ffc018217f5a1c33010bad91.js"></script>

<script>
  "use strict";

  window.onload = function() {
    
    var navCollapseBtn = document.getElementById('navCollapseBtn');
    navCollapseBtn ? navCollapseBtn.addEventListener('click', function(e) {
      var navCollapse = document.querySelector('.navbar__collapse');
      
      if (navCollapse) {
        var dataOpen = navCollapse.getAttribute('data-open');

        if (dataOpen === 'true') {
          navCollapse.setAttribute('data-open', 'false');
          navCollapse.style.maxHeight = 0;
        } else {
          navCollapse.setAttribute('data-open', 'true');
          navCollapse.style.maxHeight = navCollapse.scrollHeight + "px";
        }
      }
    }) : null;
    


    
    var expandBtn = document.querySelectorAll('.expand__button');

    for (let i = 0; i < expandBtn.length; i++) {
      expandBtn[i].addEventListener("click", function () {
        var content = this.nextElementSibling;
        if (content.style.maxHeight) {
          content.style.maxHeight = null;
          this.querySelector('svg').classList.add('expand-icon__right');
          this.querySelector('svg').classList.remove('expand-icon__down');
        } else {
          content.style.maxHeight = content.scrollHeight + "px";
          this.querySelector('svg').classList.remove('expand-icon__right');
          this.querySelector('svg').classList.add('expand-icon__down');
        }
      });
    }
    

    
    
    var root = document.getElementById('root');
    var toggleToLightBtn = document.getElementById('toggleToLight');
    var toggleToDarkBtn = document.getElementById('toggleToDark');

    toggleToDark.onclick = function(e) {
      root.className = 'theme__dark';
      localStorage.setItem('theme', 'dark');
      toggleToLightBtn.className = 'navbar__icons--icon';
      toggleToDarkBtn.className = 'hide';
    }

    toggleToLight.onclick = function (e) {
      root.className = 'theme__light';
      localStorage.setItem('theme', 'light');
      toggleToLightBtn.className = 'hide';
      toggleToDarkBtn.className = 'navbar__icons--icon';
    }


    
    document.querySelectorAll('.menu__list').forEach(function(elem) {
      if (elem.classList.contains('active')) {
        elem.style.maxHeight = elem.scrollHeight + "px"; 
      }
    });
    
    document.querySelectorAll('.menu__title--collapse').forEach(function(elem) {
      elem.addEventListener('click', function (e) {
        var content = this.nextElementSibling;
        var menuTitleIcon = this.querySelector('.menu__title--icon');
        if (!content) {
          return null;
        }

        if (content.style.maxHeight) {
          content.style.maxHeight = null;
          content.classList.remove('active');
          menuTitleIcon.classList.add('right');
          menuTitleIcon.classList.remove('down');
        } else {
          content.style.maxHeight = content.scrollHeight + "px";
          content.classList.add('active');
          menuTitleIcon.classList.remove('right');
          menuTitleIcon.classList.add('down');
        }
      });
    });
    


    
    var mobileLogo = document.getElementById('mobileLogo');
    var modal = document.getElementById("myModal");
    var drawer = document.getElementById('myDrawer');
    var drawerCloseBtn = document.querySelector('.drawer__close');

    var openDrawer = function() {
      modal.style.left = 0;
      modal.style.opacity = 1;
      drawer.style.left = 0;
    }

    var closeDrawer = function() {
      modal.style.opacity = 0;
      drawer.style.left = '-100%';
      setTimeout(function () {
        modal.style.left = '-100%';
      }, 250);
    }

    mobileLogo.onclick = function () {
      openDrawer();
      localStorage.setItem('isDrawerOpen', 'true');
    }

    modal.onclick = function () {
      closeDrawer();
      localStorage.setItem('isDrawerOpen', 'false');
    }

    drawerCloseBtn.onclick = function () {
      closeDrawer();
      localStorage.setItem('isDrawerOpen', 'false');
    }
  


  
    var lastScrollTop = window.pageYOffset || document.documentElement.scrollTop;
    var tocElem = document.querySelector('.toc');
    var tableOfContentsElem = tocElem ? tocElem.querySelector('#TableOfContents') : null;
    var singleContentsElem = document.querySelector('.single__contents');

    
    var tocLevels = JSON.parse("[\"h2\",\"h3\",\"h4\"]");

    if (tocLevels) {
      tocLevels = tocLevels.toString();
    } else {
      tocLevels = "h1, h2, h3, h4, h5, h6";
    }

    window.onscroll = function () {
      var st = window.pageYOffset || document.documentElement.scrollTop;
      if (st > lastScrollTop) { 
        singleContentsElem ? 
        singleContentsElem.querySelectorAll(tocLevels.toString()).forEach(function(elem) {
          if (document.documentElement.scrollTop >= elem.offsetTop) {
            if (tableOfContentsElem) {
              var id = elem.getAttribute('id');
              tocElem.querySelectorAll('a').forEach(function (elem) {
                elem.classList.remove('active');
              });
              tocElem.querySelector('a[href="#' + id + '"]') ? 
              tocElem.querySelector('a[href="#' + id + '"]').classList.add('active') : null;
            }
          }
        }) : null;
      } else { 
        singleContentsElem ? 
        singleContentsElem.querySelectorAll(tocLevels.toString()).forEach(function(elem) {
          if (document.documentElement.scrollTop >= elem.offsetTop) {
            if (tableOfContentsElem) {
              var id = elem.getAttribute('id');
              tocElem.querySelectorAll('a').forEach(function (elem) {
                elem.classList.remove('active');
              });
              tocElem.querySelector('a[href="#' + id + '"]') ? 
              tocElem.querySelector('a[href="#' + id + '"]').classList.add('active') : null;
            }
          }
        }) : null;
      }
      lastScrollTop = st <= 0 ? 0 : st;
    };
    



    
    var mobileSearchInputElem = document.querySelector('#search-mobile');
    var mobileSearchClassElem = document.querySelector('.mobile-search');
    var mobileSearchBtnElem = document.querySelector('#mobileSearchBtn');
    var mobileSearchCloseBtnElem = document.querySelector('#search-mobile-close');
    var mobileSearchContainer = document.querySelector('#search-mobile-container');
    var mobileSearchResultsElem = document.querySelector('#search-mobile-results');
    var htmlElem = document.querySelector('html');

    if (mobileSearchClassElem) {
      mobileSearchClassElem.style.display = 'none';
    }

    mobileSearchBtnElem ? 
    mobileSearchBtnElem.addEventListener('click', function () {
      if (mobileSearchContainer) {
        mobileSearchContainer.style.display = 'block';
      }

      if (mobileSearchInputElem) {
        mobileSearchInputElem.focus();
      }

      if (htmlElem) {
        htmlElem.style.overflowY = 'hidden';
      }
    }) : null;

    mobileSearchCloseBtnElem ? 
    mobileSearchCloseBtnElem.addEventListener('click', function() {
      if (mobileSearchContainer) {
        mobileSearchContainer.style.display = 'none';
      }

      if (mobileSearchInputElem) {
        mobileSearchInputElem.value = '';
      }
      
      if (mobileSearchResultsElem) {
        while (mobileSearchResultsElem.firstChild) {
          mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);
        }
      }

      if (htmlElem) {
        htmlElem.style.overflowY = 'visible';
      }
    }) : null;

    mobileSearchInputElem ? 
    mobileSearchInputElem.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        if (mobileSearchContainer) {
          mobileSearchContainer.style.display = 'none';
        }
        
        if (mobileSearchInputElem) {
          mobileSearchInputElem.value = '';
        }

        if (mobileSearchResultsElem) {
          while (mobileSearchResultsElem.firstChild) {
            mobileSearchResultsElem.removeChild(mobileSearchResultsElem.firstChild);
          }
        }
        if (htmlElem) {
          htmlElem.style.overflowY = 'visible';
        }
      }
    }) : null;
  


  
    var localTheme = localStorage.getItem('theme');
    var rootEleme = document.getElementById('root');
    var selectThemeElem = document.querySelectorAll('.select-theme');
    var selectThemeItemElem = document.querySelectorAll('.select-theme__item');
    
    if (localTheme) {
      selectThemeItemElem ? 
      selectThemeItemElem.forEach(function (elem) {
        if (elem.text.trim() === localTheme) {
          elem.classList.add('is-active');
        } else {
          elem.classList.remove('is-active');
        }
      }) : null;
    }

    selectThemeItemElem ? 
    selectThemeItemElem.forEach(function (v, i) {
      v.addEventListener('click', function (e) {
        var selectedThemeVariant = e.target.text.trim();
        localStorage.setItem('theme', selectedThemeVariant);

        rootEleme.removeAttribute('class');
        rootEleme.classList.add(`theme__${selectedThemeVariant}`);
        selectThemeElem.forEach(function(rootElem) {
          rootElem.querySelectorAll('a').forEach(function (elem) {
            if (elem.classList) {
              if (elem.text.trim() === selectedThemeVariant) {
                if (!elem.classList.contains('is-active')) {
                  elem.classList.add('is-active');
                }
              } else {
                if (elem.classList.contains('is-active')) {
                  elem.classList.remove('is-active');
                }
              }
            }
          });
        });

        if (window.mermaid) {
          if (selectedThemeVariant === "dark" || selectedThemeVariant === "hacker") {
            mermaid.initialize({ theme: 'dark' });
            location.reload();
          } else {
            mermaid.initialize({ theme: 'default' });
            location.reload();
          }
        }

        var utterances = document.querySelector('iframe');
        if (utterances) {
          utterances.contentWindow.postMessage({
            type: 'set-theme',
            theme: selectedThemeVariant === "dark" || selectedThemeVariant === "hacker" ? 'photon-dark' : selectedThemeVariant === 'kimbie' ? 'github-dark-orange' : 'github-light',
          }, 'https://utteranc.es');
        }
      });
    }) : null;
  


  
    
    var permalink = JSON.parse("\"/en/2020/03/agit-flow-and-git-repo/\"");
    var searchResults = null;
    var searchMenu = null;
    var searchText = null;
    
    
    var enableSearchHighlight = JSON.parse("null");

    var fuse = null;

    (function initFuse() {
      var xhr = new XMLHttpRequest();
      xhr.open('GET', permalink + "index.json");
      xhr.setRequestHeader('Content-Type', 'application/json; charset=utf-8');
      xhr.onload = function () {
        if (xhr.status === 200) {
          fuse = new Fuse(JSON.parse(xhr.response.toString('utf-8')), {
            keys: ['title', 'description', 'content'],
            includeMatches: enableSearchHighlight,
            shouldSort: true,
            threshold: 0.4,
            location: 0,
            distance: 100,
            maxPatternLength: 32,
            minMatchCharLength: 1,
          });
        }
        else {
          console.error(`[${xhr.status}]Error:`, xhr.statusText);
        }
      };
      xhr.send();
    })();
    
    function makeLi(ulElem, obj) {
      var li = document.createElement('li');
      li.className = 'search-result__item';
      
      var a = document.createElement('a');
      a.innerHTML = obj.title;
      a.setAttribute('class', 'search-result__item--title');
      a.setAttribute('href', obj.permalink);

      var descDiv = document.createElement('div');
      descDiv.setAttribute('class', 'search-result__item--desc');
      if (obj.description) {
        descDiv.innerHTML = obj.description;
      } else if (obj.content) {
        descDiv.innerHTML = obj.content.substring(0, 80);
      }
      
      li.appendChild(a);
      li.appendChild(descDiv);
      ulElem.appendChild(li);
    }

    function makeHighlightLi(ulElem, obj) {
      var li = document.createElement('li');
      li.className = 'search-result__item';
      var descDiv = null;

      var a = document.createElement('a');
      a.innerHTML = obj.item.title;
      a.setAttribute('class', 'search-result__item--title');
      a.setAttribute('href', obj.item.uri);

      if (obj.matches && obj.matches.length) {
        for (var i = 0; i < obj.matches.length; i++) {
          if ('title' === obj.matches[i].key) {
            a = document.createElement('a');
            a.innerHTML = generateHighlightedText(obj.matches[i].value, obj.matches[i].indices);
            a.setAttribute('class', 'search-result__item--title');
            a.setAttribute('href', obj.item.uri);
          }
          
          if ('description' === obj.matches[i].key) {
            descDiv = document.createElement('div');
            descDiv.setAttribute('class', 'search-result__item--desc');
            descDiv.innerHTML = generateHighlightedText(obj.item.description, obj.matches[i].indices);
          } else if ('content' === obj.matches[i].key) {
            if (!descDiv) {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = generateHighlightedText(obj.item.content.substring(0, 80), obj.matches[i].indices);
            }
          } else {
            if (obj.item.description) {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = obj.item.description;
            } else {
              descDiv = document.createElement('div');
              descDiv.setAttribute('class', 'search-result__item--desc');
              descDiv.innerHTML = obj.item.content.substring(0, 80);
            }
          }
        }

        li.appendChild(a);
        if (descDiv) {
          li.appendChild(descDiv);
        }
        if (li) {
          ulElem.appendChild(li);
        }
      }
    }

    function renderSearchResults(searchText, results) {
      searchResults = document.getElementById('search-results');
      searchMenu = document.getElementById('search-menu');
      searchResults.setAttribute('class', 'dd is-active');
      
      var ul = document.createElement('ul');
      ul.setAttribute('class', 'dd-content search-content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          a.setAttribute('href', result.uri);
          a.setAttribute('class', 'dd-item');
          a.appendChild(li);

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.title;
          titleDiv.setAttribute('class', 'search-result__item--title');

          var descDiv = document.createElement('div');
          descDiv.setAttribute('class', 'search-result__item--desc');
          if (result.description) {
            descDiv.innerHTML = result.description;
          } else if (result.content) {
            descDiv.innerHTML = result.content.substring(0, 80);
          }

          li.appendChild(titleDiv);
          li.appendChild(descDiv);
          ul.appendChild(a);
        });
      } else {
        var li = document.createElement('li');
        li.setAttribute('class', 'dd-item');
        li.innerText = 'No results found';
        ul.appendChild(li);
      }

      while (searchMenu.hasChildNodes()) {
        searchMenu.removeChild(
          searchMenu.lastChild
        );
      }
      
      searchMenu.appendChild(ul);
    }

    function renderSearchHighlightResults(searchText, results) {
      searchResults = document.getElementById('search-results');
      searchMenu = document.getElementById('search-menu');
      searchResults.setAttribute('class', 'dd is-active');

      var ul = document.createElement('ul');
      ul.setAttribute('class', 'dd-content search-content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          var descDiv = null;

          a.setAttribute('href', result.item.uri);
          a.setAttribute('class', 'dd-item');
          a.appendChild(li);

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.item.title;
          titleDiv.setAttribute('class', 'search-result__item--title');
          
          if (result.matches && result.matches.length) {
            for (var i = 0; i < result.matches.length; i++) {
              if ('title' === result.matches[i].key) {
                titleDiv.innerHTML = generateHighlightedText(result.matches[i].value, result.matches[i].indices);
              }

              if ('description' === result.matches[i].key) {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'search-result__item--desc');
                descDiv.innerHTML = generateHighlightedText(result.item.description, result.matches[i].indices);
              } else if ('content' === result.matches[i].key) {
                if (!descDiv) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'search-result__item--desc');
                  descDiv.innerHTML = generateHighlightedText(result.item.content.substring(0, 80), result.matches[i].indices);
                }
              } else {
                if (result.item.description) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'search-result__item--desc');
                  descDiv.innerHTML = result.item.description;
                } else {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'search-result__item--desc');
                  descDiv.innerHTML = result.item.content.substring(0, 80);
                }
              }
            }
            
            li.appendChild(titleDiv);
            if (descDiv) {
              li.appendChild(descDiv);
            }
            ul.appendChild(a);
          }
        });
      } else {
        var li = document.createElement('li');
        li.setAttribute('class', 'dd-item');
        li.innerText = 'No results found';
        ul.appendChild(li);
      }

      while (searchMenu.hasChildNodes()) {
        searchMenu.removeChild(
          searchMenu.lastChild
        );
      }
      searchMenu.appendChild(ul);
    }

    function renderSearchResultsMobile(searchText, results) {
      searchResults = document.getElementById('search-mobile-results');

      var content = document.createElement('div');
      content.setAttribute('class', 'mobile-search__content');

      if (results.length > 0) {
        results.forEach(function (result) {
          var item = document.createElement('a');
          item.setAttribute('href', result.uri);
          item.innerHTML = '<div class="mobile-search__item"><div class="mobile-search__item--title">📄 ' + result.title + '</div><div class="mobile-search__item--desc">' + (result.description ? result.description : result.content) + '</div></div>';
          content.appendChild(item);
        });
      } else {
        var item = document.createElement('span');
        content.appendChild(item);
      }

      let wrap = document.getElementById('search-mobile-results');
      while (wrap.firstChild) {
        wrap.removeChild(wrap.firstChild)
      }
      searchResults.appendChild(content);      
    }

    function renderSearchHighlightResultsMobile(searchText, results) {
      searchResults = document.getElementById('search-mobile-results');

      var ul = document.createElement('div');
      ul.setAttribute('class', 'mobile-search__content');

      if (results.length) {
        results.forEach(function (result) {
          var li = document.createElement('li');
          var a = document.createElement('a');
          var descDiv = null;

          a.setAttribute('href', result.item.uri);
          a.appendChild(li);
          li.setAttribute('class', 'mobile-search__item');

          var titleDiv = document.createElement('div');
          titleDiv.innerHTML = result.item.title;
          titleDiv.setAttribute('class', 'mobile-search__item--title');
          
          if (result.matches && result.matches.length) {
            for (var i = 0; i < result.matches.length; i++) {
              if ('title' === result.matches[i].key) {
                titleDiv.innerHTML = generateHighlightedText(result.matches[i].value, result.matches[i].indices);
              }

              if ('description' === result.matches[i].key) {
                descDiv = document.createElement('div');
                descDiv.setAttribute('class', 'mobile-search__item--desc');
                descDiv.innerHTML = generateHighlightedText(result.item.description, result.matches[i].indices);
              } else if ('content' === result.matches[i].key) {
                if (!descDiv) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = generateHighlightedText(result.item.content.substring(0, 150), result.matches[i].indices);
                }
              } else {
                if (result.item.description) {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = result.item.description;
                } else {
                  descDiv = document.createElement('div');
                  descDiv.setAttribute('class', 'mobile-search__item--desc');
                  descDiv.innerHTML = result.item.content.substring(0, 150);
                }
              }
            }
            
            li.appendChild(titleDiv);
            if (descDiv) {
              li.appendChild(descDiv);
            }
            ul.appendChild(a);
          }
        });
      } else {
        var item = document.createElement('span');
        ul.appendChild(item);
      }

      let wrap = document.getElementById('search-mobile-results');
      while (wrap.firstChild) {
        wrap.removeChild(wrap.firstChild)
      }
      searchResults.appendChild(ul);
    }

    function generateHighlightedText(text, regions) {
      if (!regions) {
        return text;
      }

      var content = '', nextUnhighlightedRegionStartingIndex = 0;

      regions.forEach(function(region) {
        if (region[0] === region[1]) {
          return null;
        }
        
        content += '' +
          text.substring(nextUnhighlightedRegionStartingIndex, region[0]) +
          '<span class="search__highlight">' +
            text.substring(region[0], region[1] + 1) +
          '</span>' +
        '';
        nextUnhighlightedRegionStartingIndex = region[1] + 1;
      });

      content += text.substring(nextUnhighlightedRegionStartingIndex);

      return content;
    };

    var searchElem = document.getElementById('search');
    var searchMobile = document.getElementById('search-mobile');
    var searchResultsContainer = document.getElementById('search-results');

    searchElem ? 
    searchElem.addEventListener('input', function(e) {
      if (!e.target.value | window.innerWidth < 770) {
        searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dd') : null;
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);

      if (enableSearchHighlight) {
        renderSearchHighlightResults(searchText, results);
      } else {
        renderSearchResults(searchText, results);
      }

      var dropdownItems = searchResultsContainer.querySelectorAll('.dd-item');
      dropdownItems ? dropdownItems.forEach(function (item) {
        item.addEventListener('mousedown', function (e) {
          console.log('mousedown');
          e.target.click();
        });
      }) : null;
    }) : null;

    searchElem ? 
    searchElem.addEventListener('blur', function() {
      if (window.innerWidth < 770) {
        return null;
      }
      searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dd') : null;
    }) : null;

    searchElem ? 
    searchElem.addEventListener('click', function(e) {
      if (window.innerWidth < 770) {
        return null;
      }
      if (!e.target.value) {
        searchResultsContainer ? searchResultsContainer.setAttribute('class', 'dd') : null;
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);

      if (enableSearchHighlight) {
        renderSearchHighlightResults(searchText, results);
      } else {
        renderSearchResults(searchText, results);
      }

      var dropdownItems = searchResultsContainer.querySelectorAll('.dd-item');
      dropdownItems ? dropdownItems.forEach(function (item) {
        item.addEventListener('mousedown', function (e) {
          console.log('mousedown');
          e.target.click();
        });
      }) : null;
    }) : null;

    var searchMenuElem = document.getElementById("search-menu");
    var activeItem = document.querySelector('#search-menu .dd-item.is-active');
    var activeIndex = null;
    var items = null;
    var searchContainerMaxHeight = 350;

    searchElem.addEventListener('keydown', function(e) {
      if (window.innerWidth < 770) {
        return null;
      }

      var items = document.querySelectorAll('#search-menu .dd-item');
      
      if (e.key === 'ArrowDown') {
        if (activeIndex === null) {
          activeIndex = 0;
          items[activeIndex].classList.remove('is-active');
        } else {
          items[activeIndex].classList.remove('is-active');
          activeIndex = activeIndex === items.length - 1 ? 0 : activeIndex + 1;
        }
        items[activeIndex].classList.add('is-active');

        let overflowedPixel = items[activeIndex].offsetTop + items[activeIndex].clientHeight - searchContainerMaxHeight;
        if (overflowedPixel > 0) {
          document.querySelector(".search-content").scrollTop += items[activeIndex].getBoundingClientRect().height;
        } else if (activeIndex === 0) {
          document.querySelector(".search-content").scrollTop = 0;
        }
      } else if (e.key === 'ArrowUp') {
        if (activeIndex === null) {
          activeIndex = items.length - 1;
          items[activeIndex].classList.remove('is-active');
        } else {
          items[activeIndex].classList.remove('is-active');
          activeIndex = activeIndex === 0 ? items.length - 1 : activeIndex - 1;
        }
        items[activeIndex].classList.add('is-active');
        
        let overflowedPixel = items[activeIndex].offsetTop + items[activeIndex].clientHeight - searchContainerMaxHeight;
        if (overflowedPixel < 0) {
          document.querySelector(".search-content").scrollTop -= items[activeIndex].getBoundingClientRect().height;
        } else {
          document.querySelector(".search-content").scrollTop = overflowedPixel + items[activeIndex].getBoundingClientRect().height;
        }
      } else if (e.key === 'Enter') {
        var currentItemLink = items[activeIndex].getAttribute('href');
        if (currentItemLink) {
          location.href = currentItemLink;
        }
      } else if (e.key === 'Escape') {
        e.target.value = null;
        if (searchResults) {
          searchResults.classList.remove('is-active');
        }
      }
    });

    searchMobile ? 
    searchMobile.addEventListener('input', function(e) {
      if (!e.target.value) {
        let wrap = document.getElementById('search-mobile-results');
        while (wrap.firstChild) {
          wrap.removeChild(wrap.firstChild);
        }
        return null;
      }

      searchText = e.target.value;
      var results = fuse.search(e.target.value);
      
      if (enableSearchHighlight) {
        renderSearchHighlightResultsMobile(searchText, results);
      } else {
        renderSearchResultsMobile(searchText, results);
      }

      var dropdownItems = searchResultsContainer.querySelectorAll('.dd-item');
      dropdownItems ? dropdownItems.forEach(function (item) {
        item.addEventListener('mousedown', function (e) {
          console.log('mousedown');
          e.target.click();
        });
      }) : null;
    }) : null;
  
  }
</script>

    


<link rel="stylesheet" href="/css/main.min.css">

    <meta name="description" content="" />
<meta name="keywords" content="">
<meta name="created" content="2020-03-04T08:00:00&#43;0800">
<meta name="modified" content="2020-03-04T08:00:00&#43;0800">


<meta property="og:site_name" content="git-repo: a git wrapper from Alibaba">
<meta property="og:title" content="Agit-Flow and git-repo">
<meta property="og:url" content="/en/2020/03/agit-flow-and-git-repo/">
<meta property="og:type" content="article">

<meta name="generator" content="Hugo 0.73.0" />
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="theme-color" content="#ffffff">
<link rel="canonical" href="/en/2020/03/agit-flow-and-git-repo/">
<link rel="manifest" href="/manifest.json">

  <link rel="apple-touch-icon" sizes="57x57" href="/favicon/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/favicon/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/favicon/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/favicon/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/favicon/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/favicon/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/favicon/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/favicon/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/favicon/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/favicon/android-icon-512x512.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/favicon/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">


    <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "headline": "Agit-Flow and git-repo",
    "datePublished": "2020-03-04T08:00:00+08:00",
    "dateModified": "2020-03-04T08:00:00+08:00",
    "url" : "/en/2020/03/agit-flow-and-git-repo/",
    "description": "About myself Due to the coronavirus outbreak in China, I was unable to attend the Git Merge 2020 conference to give a speech on \u0026ldquo;AGit and git-repo\u0026rdquo; in Los …",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://git-repo.info/"
    },
    "publisher": {
      "@type": "Organization",
      "name": "git-repo: a git wrapper from Alibaba",
      "url": "https://git-repo.info/"
    }
  }
</script>

    

</head>

<body id="root" class="theme__light">
    <script>
        var localTheme = localStorage.getItem('theme');
        if (localTheme) {
            document.getElementById('root').className = `theme__${localTheme}`;
        }        
    </script>
    
    <div id="container">
        <div id="myDrawer" class="drawer">
  <div class="drawer__header">
    <div class="drawer__header--text">
      git-repo
    </div>
    <div class="grow"></div>
    <div class="drawer__close">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M18.3 5.71c-.39-.39-1.02-.39-1.41 0L12 10.59 7.11 5.7c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L10.59 12 5.7 16.89c-.39.39-.39 1.02 0 1.41.39.39 1.02.39 1.41 0L12 13.41l4.89 4.89c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L13.41 12l4.89-4.89c.38-.38.38-1.02 0-1.4z"/></svg>
    </div>
  </div>

  <div class="drawer__body">
    <div class="menu">
  <h6 class="menu__label">
    
      posts
    
  </h6>
  <ul>
    
    
      
      
      
        
        
        <li class="">
          <a href="/en/2020/03/agit-flow-and-git-repo/" class="menu__title ">Agit-Flow and git-repo</a>
        </li>
      
    
  </ul>
</div>

<script>
  var menuTitle = document.querySelectorAll('.menu__title');
  var modal = document.getElementById("myModal");
  var drawer = document.getElementById('myDrawer');

  var closeDrawer = function () {
    setTimeout(function () {
      modal.style.opacity = 0;
      drawer.style.left = '-100%';
      modal.style.left = '-100%';
    }, 250);
  }

  menuTitle ? 
  menuTitle.forEach(function(elem) {
    elem.onclick = function() {
      closeDrawer();
      localStorage.setItem('isDrawerOpen', 'false');
    }
  }) : null;
</script>

  </div>
</div>
<div id="myModal" class="modal"></div>

<script>
  var isDrawerOpen = localStorage.getItem('isDrawerOpen');
  var modal = document.getElementById("myModal");
  var drawer = document.getElementById('myDrawer');

  var openDrawer = function () {
    modal.style.left = 0;
    modal.style.opacity = 1;
    drawer.style.left = 0;
  }

  if (isDrawerOpen && isDrawerOpen === 'true') {
    openDrawer();
  }
</script>
        
<nav class="nav">
  <div class="navbar__wrapper">
    <div class="divider">
      <div class="navbar lmr">
        <div id="siteLogo" class="navbar__logo--wrapper">
  
    <a href="/en/" title="" rel="home" class="navbar__logo--link">
      <img src="/logo.png" alt="Home" class="navbar__logo">
    </a>
  
  
    <a href="/en/" title="" rel="home" class="navbar__logo--text-link">
      <h6 class="navbar__logo--text">git-repo</h6>
    </a>
  
</div>
        
        <div class="navbar__menu--wrapper">
          <div id="tabletLogo" class="hide">
  
  <a href="/en/" rel="home" class="navbar__logo--link">
    <img src="/logo.png" alt="Home" class="navbar__logo">
  </a>
  
</div>
          <div id="mobileLogo" class="hide">
  <a href="#" class="navbar__logo--link">
    <div class="navbar__icons--icon">
      <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M4 18h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1zm0-5h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1zM3 7c0 .55.45 1 1 1h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1z"/></svg>
    </div>
  </a>
</div>
          <span id="navMenuMobile" class="hide">
  <button id="navCollapseBtn" class="navbar__dropdown--title" aria-label="Section Menu">
    
      posts
    
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path fill="currentColor" d="M8.12 9.29L12 13.17l3.88-3.88c.39-.39 1.02-.39 1.41 0 .39.39.39 1.02 0 1.41l-4.59 4.59c-.39.39-1.02.39-1.41 0L6.7 10.7c-.39-.39-.39-1.02 0-1.41.39-.38 1.03-.39 1.42 0z"/></svg>
  </button>
  <div class="navbar__collapse" data-open="false">
  <ul>
    

  
  
  
  
  <li class="navbar__menu--mobile-item ">
    <a href="/en/docs" class="">Docs</a>
  </li>

  
  
  
  
  <li class="navbar__menu--mobile-item ">
    <a href="/en/changelog" class="">Changelog</a>
  </li>

  
  
  
  
  <li class="navbar__menu--mobile-item ">
    <a href="/en/docs/contribution" class="">Contribution</a>
  </li>

  
  
  
  
  <li class="navbar__menu--mobile-item ">
    <a href="https://github.com/alibaba/git-repo-go/releases" class="">Download</a>
  </li>

  
  
  
  
  <li class="navbar__menu--mobile-item ">
    <a href="https://github.com/alibaba/git-repo-go" class="">GitHub</a>
  </li>

  </ul>
</div>
</span>
          <ul id="navMenu" class="navbar__menu">
            

  
  
  
  
  <li class="navbar__menu--item ">
    <a href="/en/docs">Docs</a>
  </li>

  
  
  
  
  <li class="navbar__menu--item ">
    <a href="/en/changelog">Changelog</a>
  </li>

  
  
  
  
  <li class="navbar__menu--item ">
    <a href="/en/docs/contribution">Contribution</a>
  </li>

  
  
  
  
  <li class="navbar__menu--item ">
    <a href="https://github.com/alibaba/git-repo-go/releases">Download</a>
  </li>

  
  
  
  
  <li class="navbar__menu--item ">
    <a href="https://github.com/alibaba/git-repo-go">GitHub</a>
  </li>

          </ul>
        </div>
        <div class="grow"></div>
        <div id="siteSearch">
          

<div class="search">
  <span class="icon">
    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
  </span>
  <input id="search" aria-label="Site Search" class="input" type="text" autocomplete="off" placeholder="Search">
  <div id="search-results" class="dropdown">
    <div id="search-menu" class="dropdown-menu">
    </div>
  </div>
</div>


        </div>
        <div id="mobileSearch" class="hide">
          
<div id="mobileSearchBtn" class="mobile-search__btn">
  <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
</div>

<div id="search-mobile-container" class="mobile-search hide">
  <div class="mobile-search__top">
    <input id="search-mobile" type="text" aria-label="Mobile Search" placeholder="Search..." class="mobile-search__top--input"/>
    <div id="search-mobile-close" class="mobile-search__top--icon">
      <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24"><path opacity=".87" fill="none" d="M0 0h24v24H0V0z"/><path fill="currentColor" d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm3.59-13L12 10.59 8.41 7 7 8.41 10.59 12 7 15.59 8.41 17 12 13.41 15.59 17 17 15.59 13.41 12 17 8.41z"/></svg>
    </div>
  </div>
  <div id="search-mobile-results" class="mobile-search__body">
    
  </div>
</div>

        </div>
        <div class="navbar__icons">
  
<div class="dropdown">
  <button class="lang__dropdown navbar__icons--icon" aria-label="Select Site Language">
    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M12.65 15.67c.14-.36.05-.77-.23-1.05l-2.09-2.06.03-.03c1.74-1.94 2.98-4.17 3.71-6.53h1.94c.54 0 .99-.45.99-.99v-.02c0-.54-.45-.99-.99-.99H10V3c0-.55-.45-1-1-1s-1 .45-1 1v1H1.99c-.54 0-.99.45-.99.99 0 .55.45.99.99.99h10.18C11.5 7.92 10.44 9.75 9 11.35c-.81-.89-1.49-1.86-2.06-2.88-.16-.29-.45-.47-.78-.47-.69 0-1.13.75-.79 1.35.63 1.13 1.4 2.21 2.3 3.21L3.3 16.87c-.4.39-.4 1.03 0 1.42.39.39 1.02.39 1.42 0L9 14l2.02 2.02c.51.51 1.38.32 1.63-.35zM17.5 10c-.6 0-1.14.37-1.35.94l-3.67 9.8c-.24.61.22 1.26.87 1.26.39 0 .74-.24.88-.61l.89-2.39h4.75l.9 2.39c.14.36.49.61.88.61.65 0 1.11-.65.88-1.26l-3.67-9.8c-.22-.57-.76-.94-1.36-.94zm-1.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>
  </button>
  <div class="dropdown-content lang__dropdown--content">
    
    
    
      
      
        
        
          
            
              <a href="/en/2020/03/agit-flow-and-git-repo/" data-lang="en" class="lang__dropdown--item active">English</a>
            
          
        
      
        
      
    
      
      
        
      
        
        
          
            
              <a href="/zh_cn/2020/03/agit-flow-and-git-repo/" data-lang="zh_cn" class="lang__dropdown--item">中文</a>
            
          
        
      
    
  </div>
</div>


  
<button id="toggleToDark" class="navbar__icons--icon" aria-label="Toggle to dark mode">
  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none" /><path fill="currentColor" d="M20 15.31L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6z"/></svg>
</button>
<button id="toggleToLight" class="navbar__icons--icon" aria-label="Toggle to light mode">
  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path fill="currentColor" d="M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69zM12 18c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm0-10c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4z"/></svg>
</button>
<script>
  var theme = localStorage.getItem('theme');
  var toggleToLightBtn = document.getElementById('toggleToLight');
  var toggleToDarkBtn = document.getElementById('toggleToDark');

  if (theme && theme === 'dark') {
    toggleToLightBtn.className = 'navbar__icons--icon';
    toggleToDarkBtn.className = 'hide';
  } else {
    toggleToLightBtn.className = 'hide';
    toggleToDarkBtn.className = 'navbar__icons--icon';
  }
</script>

  <div class="navbar__icons--icon">
    <a href="https://github.com/alibaba/git-repo-go" title="Github repository" aria-label="Github repository" target="_blank" rel="noreferrer">
    <svg fill="currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="22" height="22"><path d="M10.9,2.1c-4.6,0.5-8.3,4.2-8.8,8.7c-0.5,4.7,2.2,8.9,6.3,10.5C8.7,21.4,9,21.2,9,20.8v-1.6c0,0-0.4,0.1-0.9,0.1 c-1.4,0-2-1.2-2.1-1.9c-0.1-0.4-0.3-0.7-0.6-1C5.1,16.3,5,16.3,5,16.2C5,16,5.3,16,5.4,16c0.6,0,1.1,0.7,1.3,1c0.5,0.8,1.1,1,1.4,1 c0.4,0,0.7-0.1,0.9-0.2c0.1-0.7,0.4-1.4,1-1.8c-2.3-0.5-4-1.8-4-4c0-1.1,0.5-2.2,1.2-3C7.1,8.8,7,8.3,7,7.6c0-0.4,0-0.9,0.2-1.3 C7.2,6.1,7.4,6,7.5,6c0,0,0.1,0,0.1,0C8.1,6.1,9.1,6.4,10,7.3C10.6,7.1,11.3,7,12,7s1.4,0.1,2,0.3c0.9-0.9,2-1.2,2.5-1.3 c0,0,0.1,0,0.1,0c0.2,0,0.3,0.1,0.4,0.3C17,6.7,17,7.2,17,7.6c0,0.8-0.1,1.2-0.2,1.4c0.7,0.8,1.2,1.8,1.2,3c0,2.2-1.7,3.5-4,4 c0.6,0.5,1,1.4,1,2.3v2.6c0,0.3,0.3,0.6,0.7,0.5c3.7-1.5,6.3-5.1,6.3-9.3C22,6.1,16.9,1.4,10.9,2.1z"/></svg>
    </a>
  </div>
</div>


      </div>
    </div>
  </div>
</nav>

<script>
  var siteLogo = document.getElementById('siteLogo');
  var tabletLogo = document.getElementById('tabletLogo');
  var mobileLogo = document.getElementById('mobileLogo');
  var navMenu = document.getElementById('navMenu');
  var navMenuMobile = document.getElementById('navMenuMobile');
  var siteSearch = document.getElementById('siteSearch');
  var mobileSearch = document.getElementById('mobileSearch');
  
  enquire.register("screen and (max-width:1280px)", {
    match: function () {
      siteLogo.className = 'navbar__logo--wrapper';
      tabletLogo.className = 'hide';
      mobileLogo.className = 'hide';
      navMenu.className = 'navbar__menu';
      navMenuMobile.className = 'hide';
      siteSearch.className = '';
      mobileSearch.className = 'hide';
    },
    unmatch: function () {
      siteLogo.className = 'navbar__logo--wrapper';
      tabletLogo.className = 'hide';
      mobileLogo.className = 'hide';
      navMenu.className = 'navbar__menu';
      navMenuMobile.className = 'hide';
      siteSearch.className = '';
      mobileSearch.className = 'hide';
    },
  }).register("screen and (max-width:960px)", {
    match: function () {
      siteLogo.className = 'hide';
      tabletLogo.className = '';
      mobileLogo.className = 'hide';
      navMenu.className = 'navbar__menu';
      navMenuMobile.className = 'hide';
      siteSearch.className = 'hide';
      mobileSearch.className = 'navbar__icons--icon';
    },
    unmatch: function () {
      siteLogo.className = 'navbar__logo--wrapper';
      tabletLogo.className = 'hide';
      mobileLogo.className = 'hide';
      navMenu.className = 'navbar__menu';
      navMenuMobile.className = 'hide';
      siteSearch.className = '';
      mobileSearch.className = 'hide';
    },
  }).register("screen and (max-width:600px)", {
    match: function () {
      siteLogo.className = 'hide';
      tabletLogo.className = 'hide';
      mobileLogo.className = '';
      navMenu.className = 'hide';
      navMenuMobile.className = '';
      siteSearch.className = 'hide';
      mobileSearch.className = 'navbar__icons--icon';
    },
    unmatch: function () {
      siteLogo.className = 'hide';
      tabletLogo.className = '';
      mobileLogo.className = 'hide';
      navMenu.className = 'navbar__menu';
      navMenuMobile.className = 'hide';
      siteSearch.className = 'hide';
      mobileSearch.className = 'navbar__icons--icon';
    },
  });
</script>

        
 <div class="top">
  <div class="header__wrapper bgcolor__header">
    <div class="divider">
      <div class="lmr">
        <h2 class="single__title">Agit-Flow and git-repo</h2>
      </div>
    </div>
  </div>

  <div class="header__wrapper bgcolor__breadcrumb">
    <div class="divider">
      <div class="lmr flexbox">
        
          <nav class="breadcrumb" aria-label="breadcrumbs">
  <ol>
    
  
  
  
  
  
  <li >
    
      <a href="/en/" class="capitalize">Home</a>
    
  </li>
  
  
  <li >
    
      <a href="/en/posts/" class="capitalize">Posts</a>
    
  </li>
  
  
  <li  class="is-active" >
    
      <span>Agit-Flow and git-repo</span>
    
  </li>
  
  </ol>
  
</nav>

        
        <div class="grow"></div>
        

      </div>
    </div>
  </div>
</div>

        
  <div class="mid">
  <div class="divider">
    
    <nav id="single-menu" class="l">
      
        <div class="menu">
  <h6 class="menu__label">
    
      posts
    
  </h6>
  <ul>
    
    
      
      
      
        
        
        <li>
          <a href="/en/2020/03/agit-flow-and-git-repo/" class="menu__title active">Agit-Flow and git-repo</a>
        </li>
      
    
  </ul>
</div>

      
    </nav>

    <article id="list-main" class="m">
      <div class="single" data-display="block">
  

  <article class="single__contents">
    <h2 id="about-myself">About myself</h2>
<p>Due to the coronavirus outbreak in China, I was unable to attend the <a href="https://git-merge.com">Git Merge 2020</a> conference to give <a href="https://git-merge.com/#xin-jiang">a speech on &ldquo;AGit and git-repo&rdquo;</a> in Los Angeles on March 4, 2020.  It&rsquo;s a pity that I can&rsquo;t communicate face to face with developers all over the world this time. I will share the content of my speech on this blog.</p>
<p>A brief introduction to myself:</p>
<ul>
<li>
<p>I am Jiang Xin, a software engineer in Alibaba, China.</p>
</li>
<li>
<p>You might be familiar with the feature I contributed to Git: interactive git clean, and I recommend you to use <code>git clean -i</code> instead of <code>git clean -n/-f</code>.</p>
</li>
<li>
<p>I am also the Git l10n coordinator helping 14 localization teams to improve multilingual for Git.</p>
</li>
<li>
<p>I wrote a book on Git in Chinese and sent copies to Junio and Linus 10 years ago.</p>
</li>
</ul>
<h2 id="the-secret-of-gits-success">The secret of Git&rsquo;s success</h2>
<p>Git is the best choice of SCM and becomes the infrastructure for many popular source code management platforms. What is the secret behind Git&rsquo;s success?</p>
<p>Linus, the founder of Git and Linux, revealed the secret of Git&rsquo;s success in an interview on Git&rsquo;s 10th anniversary:</p>
<blockquote>
<p>The big thing about distributed source control is that it makes one of the main issues with SCM’s go away – the politics around “who can make changes.”</p>
</blockquote>
<p>The keyword in the above statement is &ldquo;politics&rdquo;. When using traditional SCM, administrators could only add write permissions to core members, so that lots of potential contributors could not make contributions to the project freely, and that&rsquo;s not good for open-source software.</p>
<p>The distributed nature of Git makes it possible for a project to have a more flexible workflow. Not only core members but also read-only users can contribute to the project in a more elegant way. For example, GitHub invented a &ldquo;Fork + Pull Request&rdquo; development model, which is the most classic and widely-used workflow so far. Instead of pushing the commits directly to a branch of the remote repository, a contributor can push his/her commits to his/her own forked fully-controlled repository and create a code review (Pull Request) later via the web interface.</p>
<h2 id="the-two-most-commonly-used-git-workflow">The two most commonly-used Git workflow</h2>
<p>There are two popular Git workflows that are introduced by GitHub and Gerrit. The two workflows have these common features:</p>
<ol>
<li>
<p>A simpler authorization model for repositories. Do not need to add write permissions to developers one by one; All read-only users can make contributions to repositories.</p>
</li>
<li>
<p>High code quality because of code review. Contributors create code reviews instead of push commits to branch directly.</p>
</li>
<li>
<p>A simpler branch model. Do not need to create a feature branch as a temporary place to create a code review.</p>
</li>
</ol>
<figure>
    <img src="/images/agit-flow/github-gerrit-comparisons-en.png"
         alt="Fig: Comparisons of GitHub and Gerrit" width="750"/> <figcaption>
            <p>Fig: Comparisons of GitHub and Gerrit</p>
        </figcaption>
</figure>

<p>Differences between these two workflows:</p>
<ol>
<li>
<p>Different models for code review.</p>
<p>Code review in GitHub is called &ldquo;pull request&rdquo;, and each feature has a pull request.</p>
<p>Code review in Gerrit is called &ldquo;change&rdquo;, and each commit generates a change.</p>
</li>
<li>
<p>Different types of workflow.</p>
<p>The workflow of GitHub is a distributed workflow. Contributors work in their own repositories.</p>
<p>The workflow of Gerrit is a centralized workflow. All users work in the same repository.</p>
</li>
<li>
<p>Different technical details.</p>
<p>GitHub workflow is &ldquo;fork + pull request&rdquo;, and its backend is CGit.</p>
<p>Gerrit users should install a special hook &ldquo;commit-msg&rdquo; inside their local repositories so that every commit generated in local repositories has a unique &ldquo;Change-Id&rdquo;. Gerrit uses JGit as its backend.</p>
</li>
<li>
<p>Pros:</p>
<p>GitHub users use standard git command, so GitHub is easy to get going. Users have full control of their forked repositories. GitHub is the largest open-source community with lots of projects, and one project can be shared to others.</p>
<p>Gerrit repositories are manageable for administrators. Android has a better solution for multi-repositories management than git-submodule.</p>
</li>
<li>
<p>Cons:</p>
<p>GitHub workflow is too heavy for one-time contribution and is hard to use with a multi-repository project like Android.</p>
<p>Gerrit is managed by one or more administrators, and a user cannot create their own repositories freely. So, one Gerrit server always hosts repositories for one project or one team. It is hard for Gerrit to form a software community.</p>
</li>
</ol>
<h2 id="agit-flow-usage">AGit-Flow Usage</h2>
<h3 id="what-is-agit-flow">What is AGit-Flow?</h3>
<p>Can we combine these two Git workflows to create a new one with all their advantages? (not like GerritHub)</p>
<p>Inspired by Gerrit workflow, we created a centralized git workflow based on CGit (instead of JGit) with a minor changed git-core and several APIs. We call the workflow as “AGit-Flow”, and implemented it in Alibaba&rsquo;s internal source code platform. With the help of &ldquo;AGit-Flow&rdquo;, it&rsquo;s unnecessary to fork a repository or create many feature branches inside a repository. Users can use <code>git push</code> command to create code review (pull request) directly.</p>
<figure>
    <img src="/images/agit-flow/agit-flow-overview-en.png"
         alt="Fig: AGit-Flow relationship with GitHub and Gerrit" width="750"/> <figcaption>
            <p>Fig: AGit-Flow relationship with GitHub and Gerrit</p>
        </figcaption>
</figure>

<p>In Alibaba, we like pull requests, we like to create or update code reviews directly from the command line, and we like CGit. We don&rsquo;t like the commit-msg hook to mangle our commits, and we are not willing to have multiple code platforms (each of which hosts part of our repositories).</p>
<p>We developed a command-line tool named &ldquo;git-repo&rdquo;, so we do not need to type long and complicated <code>git push</code> command. &ldquo;git-repo&rdquo; can be used for Gerrit, AGit-Flow and AGit-Flow alike workflows.</p>
<h3 id="work-with-agit-flow">Work with AGit-Flow</h3>
<p>See the following graph for a typical AGit-Flow workflow for a single repository:</p>
<figure>
    <img src="/images/agit-flow/agit-flow-diagram-en.png"
         alt="Fig: AGit-Flow diagram for single repository" width="600"/> <figcaption>
            <p>Fig: AGit-Flow diagram for single repository</p>
        </figcaption>
</figure>

<p>In the above graph, there are two roles. One is a developer, and the other is a committer.</p>
<p>The developer creates and updates a pull request with the following steps.</p>
<ol>
<li>
<p>Clone the remote repository to local.</p>
</li>
<li>
<p>Work in the local worktree, and create a new commit.</p>
</li>
<li>
<p>Run <code>git pr</code> command in local worktree to push the local commit to the remote server.</p>
</li>
<li>
<p>Create a new pull request on the server side. (e.g., pull request #123).</p>
</li>
<li>
<p>After receiving comments from reviewers, the developer makes a change in the worktree and creates a new commit.</p>
</li>
<li>
<p>Run <code>git pr</code> command for a second time, which will push the new commit to the remote server.</p>
</li>
<li>
<p>The remote server finds that the same user pushes commits to the same target branch with the same session (local branch), and will update an existing pull request, instead of creating a new one.</p>
</li>
</ol>
<p>The committer can write comments for the pull request; what&rsquo;s more, the committer can update the pull request with a new commit.</p>
<ol start="8">
<li>
<p>The committer runs command <code>git download 123</code> to download pull request #123 to the local repository.</p>
</li>
<li>
<p>The committer makes modifications and creates a new commit in worktree. Then, run command <code>git pr --change 123</code> to send local commit to the remote server.</p>
</li>
<li>
<p>The remote server detects this special <code>git push</code> command and will update the existing pull request which created by the developer.</p>
</li>
<li>
<p>The committer (or administrator) merge the pull request to the target branch.</p>
</li>
</ol>
<p>The following demo is AGit-Flow on a single repository of Alibaba code platform:</p>
<figure>
    <img src="/images/git-repo-single.gif"
         alt="Fig: Demo of AGit-Flow on a single repository" width="750"/> <figcaption>
            <p>Fig: Demo of AGit-Flow on a single repository</p>
        </figcaption>
</figure>

<h2 id="agit-flow-implementation">AGit-Flow Implementation</h2>
<p>A special <code>git push</code> command is used to trigger AGit-Flow workflow. This special command has a special refspec, e.g.:</p>
<pre><code>$ git push origin HEAD:refs/for/&lt;target-branch&gt;/&lt;session&gt;
</code></pre>
<ol>
<li>
<p>The target reference name of the special refspec has a prefix &ldquo;refs/for/&rdquo;. Next to the prefix is &ldquo;&lt;target-branch&gt;&rdquo;, which points to a corresponding branch in the remote repository. The last part in the special refspec is &ldquo;&lt;session&gt;&rdquo;,  and we always use name of the local branch as &ldquo;&lt;session&gt;&rdquo;. If the second <code>git push</code> command has the same target branch, the same session and from the same user, will update the already existed pull request generated by the first command instead of creating a new one.</p>
</li>
<li>
<p>There are other special prefixes for AGit-Flow, such as &ldquo;refs/drafts/&rdquo;, and &ldquo;refs/for-review/&rdquo;.</p>
<p>The prefix &ldquo;refs/drafts/&rdquo; has the same format and usage as the prefix &ldquo;refs/for/&rdquo;, but will create a pull request in draft mode. A draft mode pull request cannot be merged.</p>
<p>The prefix &ldquo;refs/for-review/&rdquo; follows a pull request ID and can be used to update specific pull request which may be generated by others.</p>
</li>
</ol>
<p>Below is a diagram of modules of the AGit-Flow server:</p>
<figure>
    <img src="/images/agit-flow/agit-flow-impl-en.png"
         alt="Fig: modules of AGit-Flow server" width="750"/> <figcaption>
            <p>Fig: modules of AGit-Flow server</p>
        </figcaption>
</figure>

<h3 id="front-end-authentication">Front-end authentication</h3>
<p>The <code>git push</code> command first reaches the front-end module of the server. The front-end module will check user permissions, and only allow a user with write permission to push.</p>
<p>As we said in the beginning, a &ldquo;politically correct&rdquo; Git workflow should allow read-only users to &ldquo;write&rdquo; to the repository. So how can we make a proper authorization system for the front-end to allow a user with write permissions to run normal <code>git push</code> (updating heads or tags), and to allow a user with read-only permissions to run special <code>git push</code> command of AGit-Flow?</p>
<p>The solution is a special environment variable or HTTP header sent to the server like follows.</p>
<figure>
    <img src="/images/agit-flow/impl-1-front-end-en.png"
         alt="Fig: Front-end authentication for AGit-Flow" width="700"/> <figcaption>
            <p>Fig: Front-end authentication for AGit-Flow</p>
        </figcaption>
</figure>

<p>The client sends a special environment for SSH protocol or adds a special HTTP header for the special <code>git push</code> command to the server.</p>
<ul>
<li>
<p>For the HTTP protocol, the <code>git push</code> command from the client side has a special option <code>-c http.extraHeader=AGIT-FLOW: &lt;agent-version&gt;</code>, which will add a special HTTP header in the request to the HTTP front-end.</p>
</li>
<li>
<p>For the SSH protocol, the client side will use a special SSH command defined by the &ldquo;GIT_SSH_COMMAND&rdquo; environment, and the special SSH command with the option <code>-o SendEnv=AGIT_FLOW</code> will send a special environment to the SSH front-end.</p>
</li>
<li>
<p>When the front-end finds a special environment (SSH protocol) or a special HTTP header (HTTP protocol), it will use a loose authorization rule (only checking for read-only permissions).</p>
</li>
<li>
<p>Warning: Please check write permission for the repository in the &ldquo;pre-receive&rdquo; hook to prevent a read-only user with a forged environment.</p>
</li>
</ul>
<h3 id="patched-git-core-and-proc-receive-hook">Patched git-core and proc-receive hook</h3>
<p>Next, requests from the client side will be delivered to the &ldquo;git-receive-pack&rdquo; process.</p>
<figure>
    <img src="/images/agit-flow/impl-2-git-core.png"
         alt="Fig: Original git-receive-pack diagram" width="320"/> <figcaption>
            <p>Fig: Original git-receive-pack diagram</p>
        </figcaption>
</figure>

<p>The original &ldquo;git-receive-pack&rdquo; process works like the follows:</p>
<ol>
<li>
<p>Requests of the client (commands and packfile) are sent one after another to the &ldquo;git-receive-pack&rdquo; process.</p>
</li>
<li>
<p>Packfile is saved (packed or unpacked) into a temporary directory for quarantine. Commands will be sent to the &ldquo;pre-receive&rdquo; hook after parsed.</p>
</li>
<li>
<p>If the &ldquo;pre-receive&rdquo; hook failed to execute, the quarantine directory will be deleted, and quit.</p>
</li>
<li>
<p>Move files in quarantine directory to objects directory.</p>
</li>
<li>
<p>Pass commands to the internal &ldquo;execute_commands&rdquo; function, execute commands (create, update, or delete references).</p>
</li>
<li>
<p>Run the &ldquo;post-receive&rdquo; hook at last for notifications.</p>
</li>
</ol>
<p>We have contributed our patched &ldquo;git-receive-pack&rdquo; for AGit-Flow to the Git community, See:</p>
<ul>
<li><a href="https://public-inbox.org/git/20200304113312.34229-1-zhiyou.jx@alibaba-inc.com/">https://public-inbox.org/git/20200304113312.34229-1-zhiyou.jx@alibaba-inc.com/</a></li>
</ul>
<p>The following diagram is our patched &ldquo;git-receive-pack&rdquo; for AGit-Flow:</p>
<figure>
    <img src="/images/agit-flow/impl-2-git-core-patched.png"
         alt="Fig: Patched git-receive-pack for AGit-Flow" width="600"/> <figcaption>
            <p>Fig: Patched git-receive-pack for AGit-Flow</p>
        </figcaption>
</figure>

<p>The changes we made for &ldquo;git-receive-pack&rdquo; to support AGit-Flow are:</p>
<ol>
<li>
<p>Add a filter for commands sent from users to &ldquo;git-receive-pack&rdquo;.</p>
</li>
<li>
<p>The filter helps to divide commands into two groups. One group of commands performs the original process, and the other group of commands does not execute the internal <code>execute_commands</code> function, but executes an external &ldquo;proc-receive&rdquo; hook instead.</p>
</li>
<li>
<p>Send an extended status report from &ldquo;receive-pack&rdquo; to cliend-side (&ldquo;send-pack&rdquo;).</p>
</li>
</ol>
<p>See the following sections.</p>
<h4 id="git-config-variable-receiveprocreceiverefs">Git config variable: receive.procReceiveRefs</h4>
<figure>
    <img src="/images/agit-flow/proc-receive-1.png" width="320"/> 
</figure>

<p>Push requests (commands) are sent to the server (git-receive-pack）one by one through its standard input. Each command has the following format:</p>
<pre><code>&lt;old-oid&gt; &lt;new-oid&gt; &lt;reference&gt;
</code></pre>
<p>Reference names of commands of AGit-Flow style <code>git push</code> have different prefixes other than &ldquo;refs/heads/&rdquo; and &ldquo;refs/tags/&rdquo;. We introduced a new git config variable &ldquo;receive.procReceiveRefs&rdquo; for Git to recognize the special commands for AGit-Flow. For example, we use the following settings for Alibaba code platform:</p>
<pre><code>git config --system --add receive.procReceiveRefs refs/for
git config --system --add receive.procReceiveRefs refs/drafts
git config --system --add receive.procReceiveRefs refs/for-review
</code></pre>
<p>The above git commands add three values for config variable &ldquo;receive.procReceiveRefs&rdquo;. Commands from clients matched either value of this config variable will be marked with a particular tag to be handled differently later.</p>
<h4 id="new-proc-receive-hook">New proc-receive Hook</h4>
<p>The commands marked with the particular tag will not be sent to the internal <code>execute_commands</code> function. They will be executed by a new external hook: &ldquo;proc-receive&rdquo;.</p>
<p>This hook executes once for the receive operation.  It takes no arguments, but uses a pkt-line format protocol to communicate with &ldquo;receive-pack&rdquo; to read commands, push-options and send results.</p>
<figure>
    <img src="/images/agit-flow/proc-receive-2.png" width="800"/> 
</figure>

<ol>
<li>
<p>Version negotiation between &ldquo;receive-pack&rdquo; and &ldquo;proc-receive&rdquo;.</p>
<p>First, &ldquo;receive-pack&rdquo; sends the protocol version and capabilities to the &ldquo;proc-receive&rdquo; hook. The hook will send back the version it supports. Currently supported capablilities include: push options, atoms, etc.</p>
</li>
<li>
<p>Send commands and push-options from &ldquo;receive-pack&rdquo; to the &ldquo;proc-receive&rdquo; hook.</p>
<p>Each command will be sent from &ldquo;receive-pack&rdquo; to &ldquo;proc-receive&rdquo; in one pkt-line of the format:</p>
<pre><code> &lt;old-oid&gt; &lt;new-oid&gt; &lt;reference&gt;
</code></pre>
<p>Commands will end with a flush-pkt.</p>
<p>Only when both &ldquo;receive-pack&rdquo; and &ldquo;proc-receive&rdquo; support &ldquo;push-options&rdquo;，&ldquo;receive-pack&rdquo; will send push-options to &ldquo;proc-receive&rdquo;.</p>
</li>
<li>
<p>The &ldquo;proc-receive&rdquo; hook will call an external API to execute the commands. In Alibaba, this API is used to create or update a pull request.</p>
</li>
<li>
<p>The &ldquo;proc-receive&rdquo; hook sends status report to &ldquo;receive-pack&rdquo;. The following formats of report are supported.</p>
<ul>
<li>
<p><code>ok &lt;ref&gt;</code></p>
<p>Successfully create or update <code>&lt;ref&gt;</code>.</p>
</li>
<li>
<p><code>ng &lt;ref&gt; &lt;reason&gt;</code></p>
<p>Fail to update <code>&lt;ref&gt;</code>, and the error message is given by <code>&lt;reason&gt;</code>.</p>
</li>
<li>
<p><code>alt &lt;ref&gt; [&lt;alt-ref&gt;] [old-oid=&lt;oid&gt;] [new-oid=&lt;oid&gt;] [forced-update]</code></p>
<p>Expect to update <code>&lt;ref&gt;</code>, but update an alternamte reference (<code>&lt;alt-ref&gt;</code>).  <code>old-oid</code>、<code>new-oid</code> and other attributes can be given by optional key-value pairs.</p>
</li>
<li>
<p><code>ft &lt;ref&gt;</code></p>
<p>Fall through, let &lsquo;receive-pack&rsquo; to execute it.</p>
</li>
</ul>
</li>
</ol>
<h4 id="extended-status-report-for-client-side-send-pack">Extended status report for client-side (&ldquo;send-pack&rdquo;)</h4>
<p>The &ldquo;proc-receive&rdquo; hook may receive a command for a pseudo-reference with a zero-old as its old-oid, while the result of the hook may point to an alternate reference and the reference may exist already with a non-zero old-oid.  We extended the format of report from &ldquo;receive-pack&rdquo; to client-side (&ldquo;send-pack&rdquo;), so git client can report correctly.</p>
<figure>
    <img src="/images/agit-flow/proc-receive-3.png" width="800"/> 
</figure>

<p>For example, the following <code>git-push</code> command has a pseudo-reference in its refspec:</p>
<pre><code>$ git push origin HEAD:refs/for/master/topic
</code></pre>
<p>New version of Git can report the actual reference updated:</p>
<pre><code>To &lt;URL/of/upstream.git&gt;
 + 263ea37...e5a9ada  HEAD -&gt; refs/pull/123/head (forced update)
</code></pre>
<h3 id="public-api-ssh-info">Public API: ssh-info</h3>
<p>Gerrit HTTP service provides a <code>ssh_info</code> API, which returns the IP address and port of the SSH server. Android repo will use this API to connect the remote server using SSH passwordless authentication.</p>
<p>AGit-Flow makes an extension for this <code>ssh_info</code> API. The return value of the API is not plain text anymore but is a JSON including protocol type (such as &ldquo;agit&rdquo;) and protocol version. And the extended <code>ssh_info</code> is not an abbreviation of &ldquo;Secure Shell information&rdquo;, but is the abbreviation of &ldquo;Smart Submit Handler information&rdquo;. This API can be provided not only from the HTTP service but also from the SSH service.</p>
<p>To see different <code>ssh_info</code> API results and various corresponding <code>git push</code> commands, see the following chart.</p>
<figure>
    <img src="/images/agit-flow/impl-4-ssh-info-en.png"
         alt="Fig: ssh_info - the Smart Submit Handler information API" width="750"/> <figcaption>
            <p>Fig: <code>ssh_info</code> - the Smart Submit Handler information API</p>
        </figcaption>
</figure>

<h2 id="git-repo">git-repo</h2>
<p>git-repo is a command-line tool for centralized workflow, can work with Gerrit, AGit-Flow compatible servers. It is written in Golang, and it can be installed easily without further dependency. It provides an easy-to-use solution for multiple repositories which is introduced by Android repo first, and it can also work with a single repository.</p>
<p>git-repo is an open-source software on GitHub.</p>
<ul>
<li>Source code: <a href="https://github.com/alibaba/git-repo-go/">https://github.com/alibaba/git-repo-go</a></li>
<li>Website: <a href="https://git-repo.info/">https://git-repo.info</a></li>
</ul>
<h3 id="installation">Installation</h3>
<ol>
<li>
<p>Download the latest release of &ldquo;git-repo&rdquo; from <a href="https://github.com/alibaba/git-repo-go/releases">https://github.com/alibaba/git-repo-go/releases</a>.</p>
<p>Choose the proper package according to your OS (Linux, Mac, or Windows) and architecture (AMD or 386), download and extract the package.</p>
</li>
<li>
<p>Make &ldquo;git-repo&rdquo; executable before install on Linux or macOS:</p>
<pre><code> $ chmod a+x git-repo
</code></pre>
</li>
<li>
<p>Move &ldquo;git-repo&rdquo; into an executable PATH (e.g., <code>/usr/local/bin</code> for Linux or macOS, <code>C:\Windows\system32</code> for Windows):</p>
<pre><code> $ sudo mv git-repo /usr/local/bin/
</code></pre>
</li>
</ol>
<h3 id="execute-git-repo-for-the-first-time">Execute git-repo for the first time</h3>
<p>git-repo will perform some initialization tasks on the first execution. See: <a href="../../gitconfig">git config extensions</a>. Running any command will trigger the initialization tasks.</p>
<pre><code>$ git repo --version
</code></pre>
<p>Note: git-repo will be recognized as git subcommand so that we can execute <code>git repo</code> (without a dash).</p>
<p>The following alias commands are installed by the initialization tasks:</p>
<figure>
    <img src="/images/agit-flow/git-repo-aliases-en.png"
         alt="Fig: Alias commands of git-repo" width="450"/> <figcaption>
            <p>Fig: Alias commands of git-repo</p>
        </figcaption>
</figure>

<p>Show help message of git-repo:</p>
<pre><code>$ git repo -h
</code></pre>
<p>Show help message of subcommands of git-repo, see the following examples:</p>
<pre><code>$ git repo help init
$ git repo help sync
</code></pre>
<h3 id="working-on-a-single-repository">Working on a single repository</h3>
<p>git-repo provides several alias commands for git workflow on a single repository:</p>
<ul>
<li><code>git peer-review</code> or <code>git pr</code>: publish local commits to create a code review.</li>
<li><code>git download</code>: download a code review from remote to the local repository.</li>
<li><code>git abandon</code>: prune already published local branch.</li>
</ul>
<p>Demo for git workflow on a single repository:</p>
<figure>
    <img src="/images/git-pr-demo.gif"
         alt="Fig: Demo of git pr" width="750"/> <figcaption>
            <p>Fig: Demo of git pr</p>
        </figcaption>
</figure>

<h3 id="working-on-multiple-repositories">Working on multiple repositories</h3>
<p>Git built-in solution for multiple repositories is git-submodule. It is OK for the release of the source code of all related repositories, but it is bad for development because all sub repositories pin to specific commits.</p>
<p>Android project introduced a better solution for the management of multiple repositories that the relationship of repositories is defined in an XML file in a manifest project. Android also introduced a new command-line tool named repo, which helps manage repositories.</p>
<p>git-repo is compatible with Android repo and can work on multiple repositories managed by a manifest repository.</p>
<ol>
<li>
<p>Create a workspace.</p>
<pre><code> $ mkdir workspace
 $ cd workspace
</code></pre>
</li>
<li>
<p>Initialize workspace from a manifest project (repository), which has an XML file (e.g., default.xml) to describe the relationship of the sub-projects.</p>
<pre><code> $ git repo init -u &lt;manifest repository&gt;
</code></pre>
</li>
<li>
<p>Fetch all sub-projects and checkout to the local workspace.</p>
<pre><code> $ git repo sync
</code></pre>
</li>
<li>
<p>Create a local branch on all projects for development.</p>
<pre><code> $ git repo start --all &lt;branch/name&gt;
</code></pre>
</li>
<li>
<p>Working in the workspace and make new commits.</p>
</li>
<li>
<p>Run the following commands to send local commits to the remote server to create code reviews (pull requests).</p>
<pre><code> $ git repo upload
</code></pre>
</li>
</ol>
<p>The following example is how to manage multiple repositories using git-repo:</p>
<figure>
    <img src="/images/git-repo-manifest.gif"
         alt="Fig: Demo of git-repo for multiple repositories"/> <figcaption>
            <p>Fig: Demo of git-repo for multiple repositories</p>
        </figcaption>
</figure>

<h3 id="git-repo-is-extensible">git-repo is extensible</h3>
<p>git-repo is extensible, can work with Gerrit, AGit-Flow, and other compatible protocols.</p>
<p>You can add new protocol support in git-repo by:</p>
<ul>
<li>
<p>Method 1: Add a new protocol helper, which implements the <code>ProtoHelper</code> interface in the <code>helper</code> directory of git-repo.</p>
</li>
<li>
<p>Method 2: Add an external program, which should support <code>--upload</code>、<code>--download</code> parameters, as the helper for your protocol.</p>
</li>
</ul>
<figure>
    <img src="/images/agit-flow/impl-git-repo-extension-en.png"
         alt="Fig: git-repo protocol extension" width="750"/> <figcaption>
            <p>Fig: git-repo protocol extension</p>
        </figcaption>
</figure>

<h2 id="summary">Summary</h2>
<p>AGit-Flow is a centralized git workflow inspired by Gerrit, but with CGit, and use pull requests for code review.</p>
<p>git-repo is a client for AGit-Flow, developed using Golang, and is compatible with Android repo.</p>
<p>Open source on GitHub:</p>
<ul>
<li>
<p><a href="https://github.com/alibaba/git-repo-go">https://github.com/alibaba/git-repo-go</a> (Give me a ⭐️)</p>
</li>
<li>
<p><a href="https://github.com/alibaba/git-repo-go-doc">https://github.com/alibaba/git-repo-go-doc</a> (For website <a href="https://git-repo.info">https://git-repo.info</a>)</p>
</li>
<li>
<p><a href="https://public-inbox.org/git/20200304113312.34229-1-zhiyou.jx@alibaba-inc.com/">https://public-inbox.org/git/20200304113312.34229-1-zhiyou.jx@alibaba-inc.com/</a> (Patches on git-receive-pack for AGit-Flow)</p>
</li>
</ul>
<p>Implement your own &ldquo;AGit-Flow&rdquo;:</p>
<ul>
<li>
<p>Assign a name for your AGit-Flow compatible protocol. (github-flow?)</p>
</li>
<li>
<p>Make your front-end ready for read-only users to push.</p>
</li>
<li>
<p>Install patched git-core in your server and set the special config variable to turn on the feature.</p>
</li>
<li>
<p>Write your own &ldquo;proc-receive&rdquo; hook and internal code review API.</p>
</li>
<li>
<p>Add a public <code>ssh_info</code> API, which returns a JSON response for service detection.</p>
</li>
<li>
<p>Add a new helper to git-repo to support your public Git service.</p>
</li>
</ul>
<hr />
<p>Edit:</p>
<ul>
<li>2020/4/27: Hook is renamed from &ldquo;execute-commands&rdquo; to &ldquo;proc-receive&rdquo;.</li>
<li>2020/4/27: Use a pkt-line format protocol between &ldquo;receive-pack&rdquo; and &ldquo;proc-receive&rdquo;.</li>
</ul>

  </article>
</div>
      

      
  
    <div id="utterances"></div>
<noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    try {
      
      var owner = JSON.parse("\"jiangxin\"");
      
      var repo = JSON.parse("\"alibaba/git-repo-go-doc\"");
      var localTheme = localStorage.getItem('theme');
      var utterTheme = localTheme === "dark" || localTheme === "hacker" ? 'photon-dark' : localTheme === 'kimbie' ? 'github-dark-orange' : 'github-light'

      var myScript = document.createElement('script');
      myScript.setAttribute('src', 'https://utteranc.es/client.js');
      myScript.setAttribute('repo', `${owner}/${repo}`);
      myScript.setAttribute('issue-term', 'pathname');
      myScript.setAttribute('theme', utterTheme);
      myScript.setAttribute('crossorigin', 'anonymous');
      myScript.setAttribute('async', '');

      myScript.onload = function() {
      }

      document.getElementById('utterances').appendChild(myScript);
    } catch (err) {
      console.log(err);
    }
  });
</script>

  

    </article>
    
    <section id="list-side" class="r">
      
        <div class="toc">
  <h6 class="toc__label">What&#39;s on this Page</h6>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#about-myself">About myself</a></li>
    <li><a href="#the-secret-of-gits-success">The secret of Git&rsquo;s success</a></li>
    <li><a href="#the-two-most-commonly-used-git-workflow">The two most commonly-used Git workflow</a></li>
    <li><a href="#agit-flow-usage">AGit-Flow Usage</a>
      <ul>
        <li><a href="#what-is-agit-flow">What is AGit-Flow?</a></li>
        <li><a href="#work-with-agit-flow">Work with AGit-Flow</a></li>
      </ul>
    </li>
    <li><a href="#agit-flow-implementation">AGit-Flow Implementation</a>
      <ul>
        <li><a href="#front-end-authentication">Front-end authentication</a></li>
        <li><a href="#patched-git-core-and-proc-receive-hook">Patched git-core and proc-receive hook</a>
          <ul>
            <li><a href="#git-config-variable-receiveprocreceiverefs">Git config variable: receive.procReceiveRefs</a></li>
            <li><a href="#new-proc-receive-hook">New proc-receive Hook</a></li>
            <li><a href="#extended-status-report-for-client-side-send-pack">Extended status report for client-side (&ldquo;send-pack&rdquo;)</a></li>
          </ul>
        </li>
        <li><a href="#public-api-ssh-info">Public API: ssh-info</a></li>
      </ul>
    </li>
    <li><a href="#git-repo">git-repo</a>
      <ul>
        <li><a href="#installation">Installation</a></li>
        <li><a href="#execute-git-repo-for-the-first-time">Execute git-repo for the first time</a></li>
        <li><a href="#working-on-a-single-repository">Working on a single repository</a></li>
        <li><a href="#working-on-multiple-repositories">Working on multiple repositories</a></li>
        <li><a href="#git-repo-is-extensible">git-repo is extensible</a></li>
      </ul>
    </li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>
</div>
      
    </section>

  </div>
</div>

<script>
  var listSide = document.getElementById('list-side');
  var listMain = document.getElementById('list-main');
  var singleMenu = document.getElementById('single-menu');

  enquire.register("screen and (max-width:1280px)", {
    match: function () {
      listSide.className = 'r';
      listMain.className = 'm';
      singleMenu.className = 'l';
    },
    unmatch: function () {
      listSide.className = 'r';
      listMain.className = 'm';
      singleMenu.className = 'l';
    },
  }).register("screen and (max-width:960px)", {
    match: function () {
      listSide.className = 'hide';
      listMain.className = 'mr';
      singleMenu.className = 'l';
    },
    unmatch: function () {
      listSide.className = 'r';
      listMain.className = 'm';
      singleMenu.className = 'l';
    },
  }).register("screen and (max-width:600px)", {
    match: function () {
      listSide.className = 'hide';
      listMain.className = 'lmr';
      singleMenu.className = 'hide';
    },
    unmatch: function () {
      listSide.className = 'hide';
      listMain.className = 'mr';
      singleMenu.className = 'l';
      
    },
  });
</script>

        
<div class="bot">
  <footer class="footer">
    <div class="divider">
      <div class="lmr">
        <p class="caption">
          ©2022, All Rights Reserved <div style='width:800px;margin:0 auto; padding:20px 0;'> <span class='caption'> <a href='http://idinfo.zjamr.zj.gov.cn/bscx.do?method=lzxx&id=3301843301000000126540' target='_blank'><img src='//gw.alicdn.com/tfs/TB1GxwdSXXXXXa.aXXXXXXXXXXX-65-70.gif' style='display:inline-block;text-decoration:none;width:18px;height:18px;' /></a> <a target='_blank' href='http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33011002015835' style='display:inline-block;text-decoration:none;height:20px;line-height:20px;'>    <img src='//img.alicdn.com/tfs/TB1..50QpXXXXX7XpXXXXXXXXXX-40-40.png' style='display:inline-block;text-decoration:none;width:18px;height:18px;'/> 浙公网安备 33011002015835号 </a> </span> | <span class='caption'><a target='_blank' href='https://beian.miit.gov.cn/'>浙ICP备12022327号-722</a></span> </div>
        </p>
        
            <p class="caption">Powered by <a href="https://gohugo.io/" rel="noreferrer">Hugo</a> and the <a href="https://github.com/zzossig/hugo-theme-zdoc" rel="noreferrer">zDoc theme</a></p>
        
      </div>
    </div>
  </footer>
</div>

    </div>

</body>

</html>